{
  "version": 3,
  "file": "bundle.css",
  "sources": [
    "../../App.svelte",
    "../../YesterdayTimeline.svelte"
  ],
  "sourcesContent": [
    "<script>\n  import { onMount } from \"svelte\";\n  import { json } from \"d3-fetch\";\n\n  import \"./../css/app.css\";\n  // import {} from \"./../stores\";\n\n  import YesterdayTimeline from \"./YesterdayTimeline.svelte\";\n\n  let data = {};\n  let didError = false;\n  const baseUrl = \"https://pudding.cool/misc/analytics\";\n  const cuts = [\n    \"browser-monthly\",\n    \"device-monthly\",\n    \"device-pages-alltime\",\n    \"pages-hourly-yesterday\",\n    \"referrers-domain-alltime\",\n    \"referrers-topic-alltime\"\n  ];\n\n  onMount(() => {\n    try {\n      cuts.forEach(async cut => {\n        const res = await json(\n          `${baseUrl}/${cut}.json?version=${new Date().getTime()}`\n        );\n        data[cut] = res[\"data\"];\n        console.log(data);\n      });\n    } catch (e) {\n      console.log(e);\n      didError = true;\n    }\n  });\n</script>\n\n<div class=\"c\">\n  {#if didError}\n    <div class=\"error\">There was an issue loading the data</div>\n  {:else if data}\n    <YesterdayTimeline data=\"{data['pages-hourly-yesterday']}\" />\n  {/if}\n\n</div>\n\n<style>\n.c {\n  padding: 3em 2em;\n}\n.error {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  width: 100%;\n  height: 90vh;\n}</style>\n",
    "<script>\n  import { range, sum } from \"d3-array\";\n  import { scaleLinear } from \"d3-scale\";\n  import { format } from \"d3-format\";\n  import { timeFormat, utcParse } from \"d3-time-format\";\n  import { area, curveMonotoneX } from \"d3-shape\";\n\n  export let data = [];\n  console.log(data);\n\n  const numberToHour = d => timeFormat(\"%-I %p\")(utcParse(\"%-H\")(d));\n\n  let parsedData = [];\n  let areaD = \"\";\n  let xTicks = [];\n  let yTicks = [];\n  let selectedItemIndex = 0;\n\n  const hours = range(0, 24);\n\n  const updateData = () => {\n    if (!data || !data.length) return;\n\n    let totalTraffic = hours.map(_ => 0);\n    const values = Object.values(data).map(d => d[\"values\"]);\n    values.forEach(hours => {\n      hours.forEach(({ hour, count }) => {\n        totalTraffic[hour] += count;\n      });\n    });\n    console.log(totalTraffic);\n\n    const xScale = scaleLinear()\n      .domain([0, 23])\n      .range([0, 100]);\n    const yScale = scaleLinear()\n      .domain([0, Math.max(...totalTraffic)])\n      .range([100, 0]);\n    const areaGenerator = area()\n      .x((d, i) => xScale(i))\n      .y1(d => yScale(d))\n      .y0(yScale(0))\n      .curve(curveMonotoneX);\n    areaD = areaGenerator(totalTraffic);\n    xTicks = xScale.ticks(5).map(value => [numberToHour(value), xScale(value)]);\n    yTicks = yScale\n      .ticks(5)\n      .map(value => [value, yScale(value)])\n      .filter(d => d[0]);\n\n    parsedData = data\n      .map(d => ({\n        ...d,\n        totalCount: sum(d[\"values\"].map(d => d[\"count\"])),\n        area: areaGenerator(\n          hours.map(\n            i => (d[\"values\"].find(d => d[\"hour\"] == i) || {})[\"count\"] || 0\n          )\n        )\n      }))\n      .sort((a, b) => b[\"totalCount\"] - a[\"totalCount\"]);\n  };\n  $: data, updateData();\n</script>\n\n<div class=\"c\">\n  <div class=\"timeline\">\n    <svg viewBox=\"0 0 100 100\" preserveAspectRatio=\"none\">\n      <path class=\"total\" d=\"{areaD}\"></path>\n      <path\n        class=\"highlighted\"\n        d=\"{parsedData[selectedItemIndex] ? parsedData[selectedItemIndex]['area'] : ''}\"></path>\n    </svg>\n    <div class=\"ticks ticks--x\">\n      {#each xTicks as [label, offset]}\n        <div class=\"tick tick--x\" style=\"{`left: ${offset}%`}\">{label}</div>\n      {/each}\n    </div>\n    <div class=\"ticks ticks--y\">\n      {#each yTicks as [label, offset]}\n        <div class=\"tick tick--y\" style=\"{`top: ${offset}%`}\">{label}</div>\n      {/each}\n    </div>\n  </div>\n  <div class=\"list\">\n    <div class=\"header\">\n      <div>Page</div>\n      <div>Visits</div>\n    </div>\n    <div class=\"items\">\n      {#each parsedData as page, i}\n        <div\n          class=\"item\"\n          class:active=\"{selectedItemIndex == i}\"\n          on:mouseenter=\"{() => (selectedItemIndex = i)}\"\n          on:mouseleave=\"{() => (selectedItemIndex = null)}\">\n          <div class=\"label\" title=\"{page.hed}\">{page.hed}</div>\n          <div class=\"value\">{format(',')(page.totalCount)}</div>\n        </div>\n      {/each}\n    </div>\n  </div>\n</div>\n\n<style>\n.c {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  width: 100%;\n  height: 15em;\n  margin: 0 auto;\n}\n.timeline {\n  position: relative;\n  -webkit-box-flex: 2;\n      -ms-flex: 2;\n          flex: 2;\n}\nsvg {\n  width: 100%;\n  height: 100%;\n}\n.list {\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n  font-size: 0.8em;\n  padding-left: 1em;\n}\n.header {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: justify;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n  text-transform: uppercase;\n  letter-spacing: 0.1em;\n  font-size: 0.9em;\n  font-family: var(--figure-font);\n  margin: 0 1em;\n}\n.items {\n  height: 19em;\n  overflow: hidden;\n}\n.items:hover {\n  overflow: auto;\n}\n.total {\n  fill: var(--gray-light);\n}\n.highlighted {\n  fill: var(--accent-medium);\n  -webkit-transition: all 0.3s ease-out;\n  -o-transition: all 0.3s ease-out;\n  transition: all 0.3s ease-out;\n}\n.item {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: justify;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n  padding: 0.3em 1em;\n}\n.item.active {\n  background: var(--accent-lighter);\n}\n.label {\n  white-space: nowrap;\n  -o-text-overflow: ellipsis;\n     text-overflow: ellipsis;\n  overflow: hidden;\n  padding-right: 0.6em;\n}\n.value {\n  font-family: var(--figure-font);\n  -webkit-font-feature-settings: \"tnum\", 1;\n          font-feature-settings: \"tnum\", 1;\n}\n\n.tick {\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n.ticks {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  font-family: var(--figure-font);\n  -webkit-font-feature-settings: \"tnum\", 1;\n          font-feature-settings: \"tnum\", 1;\n  font-size: 0.8em;\n}\n.ticks--x {\n  top: 100%;\n  text-align: center;\n}\n.ticks--y {\n  /* text-align: right; */\n  left: 0.6em;\n}</style>\n"
  ],
  "names": [],
  "mappings": "AA+CA,EAAE,eAAC,CAAC,AACF,OAAO,CAAE,GAAG,CAAC,GAAG,AAClB,CAAC,AACD,MAAM,eAAC,CAAC,AACN,OAAO,CAAE,WAAW,CACpB,OAAO,CAAE,WAAW,CACpB,OAAO,CAAE,IAAI,CACb,iBAAiB,CAAE,MAAM,CACrB,cAAc,CAAE,MAAM,CAClB,WAAW,CAAE,MAAM,CAC3B,gBAAgB,CAAE,MAAM,CACpB,aAAa,CAAE,MAAM,CACjB,eAAe,CAAE,MAAM,CAC/B,KAAK,CAAE,IAAI,CACX,MAAM,CAAE,IAAI,AACd,CAAC;AC2CD,EAAE,cAAC,CAAC,AACF,OAAO,CAAE,WAAW,CACpB,OAAO,CAAE,WAAW,CACpB,OAAO,CAAE,IAAI,CACb,KAAK,CAAE,IAAI,CACX,MAAM,CAAE,IAAI,CACZ,MAAM,CAAE,CAAC,CAAC,IAAI,AAChB,CAAC,AACD,SAAS,cAAC,CAAC,AACT,QAAQ,CAAE,QAAQ,CAClB,gBAAgB,CAAE,CAAC,CACf,QAAQ,CAAE,CAAC,CACP,IAAI,CAAE,CAAC,AACjB,CAAC,AACD,GAAG,cAAC,CAAC,AACH,KAAK,CAAE,IAAI,CACX,MAAM,CAAE,IAAI,AACd,CAAC,AACD,KAAK,cAAC,CAAC,AACL,gBAAgB,CAAE,CAAC,CACf,QAAQ,CAAE,CAAC,CACP,IAAI,CAAE,CAAC,CACf,SAAS,CAAE,KAAK,CAChB,YAAY,CAAE,GAAG,AACnB,CAAC,AACD,OAAO,cAAC,CAAC,AACP,OAAO,CAAE,WAAW,CACpB,OAAO,CAAE,WAAW,CACpB,OAAO,CAAE,IAAI,CACb,gBAAgB,CAAE,OAAO,CACrB,aAAa,CAAE,OAAO,CAClB,eAAe,CAAE,aAAa,CACtC,cAAc,CAAE,SAAS,CACzB,cAAc,CAAE,KAAK,CACrB,SAAS,CAAE,KAAK,CAChB,WAAW,CAAE,IAAI,aAAa,CAAC,CAC/B,MAAM,CAAE,CAAC,CAAC,GAAG,AACf,CAAC,AACD,MAAM,cAAC,CAAC,AACN,MAAM,CAAE,IAAI,CACZ,QAAQ,CAAE,MAAM,AAClB,CAAC,AACD,oBAAM,MAAM,AAAC,CAAC,AACZ,QAAQ,CAAE,IAAI,AAChB,CAAC,AACD,MAAM,cAAC,CAAC,AACN,IAAI,CAAE,IAAI,YAAY,CAAC,AACzB,CAAC,AACD,YAAY,cAAC,CAAC,AACZ,IAAI,CAAE,IAAI,eAAe,CAAC,CAC1B,kBAAkB,CAAE,GAAG,CAAC,IAAI,CAAC,QAAQ,CACrC,aAAa,CAAE,GAAG,CAAC,IAAI,CAAC,QAAQ,CAChC,UAAU,CAAE,GAAG,CAAC,IAAI,CAAC,QAAQ,AAC/B,CAAC,AACD,KAAK,cAAC,CAAC,AACL,OAAO,CAAE,WAAW,CACpB,OAAO,CAAE,WAAW,CACpB,OAAO,CAAE,IAAI,CACb,gBAAgB,CAAE,OAAO,CACrB,aAAa,CAAE,OAAO,CAClB,eAAe,CAAE,aAAa,CACtC,OAAO,CAAE,KAAK,CAAC,GAAG,AACpB,CAAC,AACD,KAAK,OAAO,cAAC,CAAC,AACZ,UAAU,CAAE,IAAI,gBAAgB,CAAC,AACnC,CAAC,AACD,MAAM,cAAC,CAAC,AACN,WAAW,CAAE,MAAM,CACnB,gBAAgB,CAAE,QAAQ,CACvB,aAAa,CAAE,QAAQ,CAC1B,QAAQ,CAAE,MAAM,CAChB,aAAa,CAAE,KAAK,AACtB,CAAC,AACD,MAAM,cAAC,CAAC,AACN,WAAW,CAAE,IAAI,aAAa,CAAC,CAC/B,6BAA6B,CAAE,MAAM,CAAC,CAAC,CAAC,CAChC,qBAAqB,CAAE,MAAM,CAAC,CAAC,CAAC,AAC1C,CAAC,AAED,KAAK,cAAC,CAAC,AACL,QAAQ,CAAE,QAAQ,CAClB,GAAG,CAAE,CAAC,CACN,IAAI,CAAE,CAAC,AACT,CAAC,AACD,MAAM,cAAC,CAAC,AACN,QAAQ,CAAE,QAAQ,CAClB,GAAG,CAAE,CAAC,CACN,KAAK,CAAE,CAAC,CACR,MAAM,CAAE,CAAC,CACT,IAAI,CAAE,CAAC,CACP,WAAW,CAAE,IAAI,aAAa,CAAC,CAC/B,6BAA6B,CAAE,MAAM,CAAC,CAAC,CAAC,CAChC,qBAAqB,CAAE,MAAM,CAAC,CAAC,CAAC,CACxC,SAAS,CAAE,KAAK,AAClB,CAAC,AACD,SAAS,cAAC,CAAC,AACT,GAAG,CAAE,IAAI,CACT,UAAU,CAAE,MAAM,AACpB,CAAC,AACD,SAAS,cAAC,CAAC,AAET,IAAI,CAAE,KAAK,AACb,CAAC"
}